Run Spatial Analysis R codes using AWS instances - Notes2

0. Upload all the datasets that we need into AWS S3 Bucket
-- Make sure your AWS instances will have access to files

1. Create an instance using AWS (t3-Medium) and login using Putty

sudo yum install unzip
curl "https://s3.amazonaws.com/aws-cli/awscli-bundle.zip" -o "awscli-bundle.zip"
unzip awscli-bundle.zip
$ sudo ./awscli-bundle/install -i /usr/local/aws -b /usr/local/bin/aws

aws configure

yum groupinstall "Development tools"

sudo yum install libxml2-devel

wget http://download.osgeo.org/gdal/gdal-1.9.0.tar.gz
tar xvfz gdal-1.9.0.tar.gz
cd gdal-1.9.0
./configure 
make
sudo make install
cd ..

wget http://download.osgeo.org/proj/proj-4.9.2.tar.gz
tar xvfz proj-4.9.2.tar.gz
cd proj-4.9.2
./configure 
make
sudo make install
cd ..

sudo echo /usr/local/lib >> /etc/ld.so.conf
sudo ldconfig

wget http://prdownloads.sourceforge.net/libpng/libpng-1.5.4.tar.gz
tar xvfz libpng-1.5.4.tar.gz
cd libpng-1.5.4
./configure
./configure --prefix=/usr
make
sudo make install
cd ..

sudo yum install -y R
wget https://download2.rstudio.org/rstudio-server-rhel-0.99.465-x86_64.rpm
sudo yum install -y --nogpgcheck rstudio-server-rhel-0.99.465-x86_64.rpm
sudo adduser ruser
sudo passwd ruser

R

install.packages("MASS")
install.packages("plyr")
install.packages("knitr")
install.packages("caret")
install.packages("sqldf")
install.packages("ggplot2")
install.packages("sp")
install.packages("raster")
install.packages("maptools")
install.packages("maps")
install.packages("rgdal")
install.packages("gpclib")
install.packages("lattice")
install.packages("RColorBrewer")
install.packages("classInt")
install.packages("mime")
install.packages("stringi")
install.packages("magrittr")
install.packages("evaluate")
install.packages("digest")
install.packages("formatR")
install.packages("highr")
install.packages("htmltools")
install.packages("rmarkdown")
install.packages("markdown")
install.packages("stringr")
install.packages("Rcpp")
install.packages("googleVis")
install.packages("RgoogleMaps")
install.packages("rworldmap")
install.packages("dismo")

quit()

2. Create AMI Image for the session

3. Terminate the instance

4. Create a new instance using AMI
 
5. Login to the instance using Putty again 
(Note: While creating instance add 8787 port)

6. Change user to Super User
sudo su

7. Change the directory to R directory
cd ../ruser

8. Download the data from S3 files
wget https://s3-us-west-2.amazonaws.com/spatialanalysiscolaberry/ghcnd-stations.txt
wget https://s3-us-west-2.amazonaws.com/spatialanalysiscolaberry/mly-prcp-filled.txt

9. Run RStudio in Local Broswer
IPaddress:PortNumber

10. Login to RStudio with username and password we gave while installing.

11. Run R codes from the GUI

12. Copy the output data sets to local directory or S3
aws s3 cp example.html s3://spatialanalysiscolaberry/example.html --acl public-read
